var JSON;if(!JSON){JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());if(typeof BLOOMBERG==="undefined"||!BLOOMBERG){var BLOOMBERG={};(function(){BLOOMBERG.namespace=function(b){var a=[],d,c;a=b.split(".");d=BLOOMBERG;if(a[0]==="BLOOMBERG"){a.shift()}for(c=0;c<a.length;c++){if(typeof d[a[c]]==="undefined"){d[a[c]]={}}d=d[a[c]]}return d}})()}(function(){var b=BLOOMBERG.namespace("b_persist"),a={},c={};b.has_local_storage=function(){return window.localStorage?true:false};b.init=function(){if(!b.has_local_storage()){var d=document.createElement("div");d.id="q_ie_storage";d.style.display="none";d.addBehavior("#default#userData");document.body.appendChild(d);d.load("local_storage")}};b.get=function(d){var e;if(b.has_local_storage()){e=localStorage.getItem(d)}else{var f=document.getElementById("q_ie_storage");if(f){e=f.getAttribute(d)}else{e=null}}return e};b.set=function(d,f){if(b.has_local_storage()){localStorage.setItem(d,f)}else{var e=document.getElementById("q_ie_storage");e.setAttribute(d,f);e.save("local_storage")}},b.remove=function(d){if(b.has_local_storage()){localStorage.removeItem(d)}else{var e=document.getElementById("ps");e.removeAttribute(d);e.save("local_storage")}}})();if(typeof BLOOMBERG==="undefined"||!BLOOMBERG){var BLOOMBERG={};(function(){BLOOMBERG.namespace=function(b){var a=[],d,c;a=b.split(".");d=BLOOMBERG;if(a[0]==="BLOOMBERG"){a.shift()}for(c=0;c<a.length;c++){if(typeof d[a[c]]==="undefined"){d[a[c]]={}}d=d[a[c]]}return d}})()}(function(){var w=BLOOMBERG.namespace("queue"),i={},y={poll_interval:100,return_to:document.location.href};w.STATUS={NOT_IN_Q:0,IN_Q:1,ARCHIVED:2,READ:3,FAVORITE:4,ARCHIVED_FAVORITE:5,READ_FAVORITE:6,ARCHIVED_READ:7,ARCHIVED_READ_FAVORITE:8};var j=w.STATUS;var h=function(B){var C=document.createElement("iframe");C.style.display="none";C.style.width="0px";C.style.height="0px";C.src=BLOOMBERG.global_var.Q_URI+"/proxy#"+encodeURI($.param(B));$(C).load(function(){});$("#reg_proxy_container").append(C)};var p=function(F,C,D,E,B){$.ajax({url:C,type:F,data:D,dataType:"jsonp",success:E,error:B})};var d={};w.addResponder=function(D,C){var B=d[D];if(typeof(B)=="undefined"){B=new Array()}B.push(C);d[D]=B};var z=function(F,E){var C=d[F];if(typeof(C)=="undefined"||C.length==0){return}var B=C.length;for(var D=0;D<B;D++){C[D].call(w,F,E)}};var e=function(D){var B=D.data;var E;if(D.origin&&D.origin!=i.origin){return}try{E=B.split("|");if(E[0]!="q"){return}z(E[1],(E.length<3?"":E[2]))}catch(C){}};var q=function(G,F){var C=d[G];if(typeof(C=="undefined")){return}var B=C.length;for(var E=0;E<B;E++){var D=C[E];if(D==F){if(!Array.prototype.remove){Array.prototype.remove=function(J,I){var H=this.slice((I||J)+1||this.length);this.length=J<0?this.length+J:J;return this.push.apply(this,H)}}C.remove(E);return}}};function v(){BLOOMBERG.queue.addResponder("add",b);BLOOMBERG.queue.addResponder("favorite",g);BLOOMBERG.queue.addResponder("unfavorite",f);BLOOMBERG.queue.addResponder("archive",a);BLOOMBERG.queue.addResponder("read",o);BLOOMBERG.queue.addResponder("merge",k)}var u,A;var s=function(B){if(typeof(A)!="undefined"){return}u=window.location.hash;w._fragmentPoller=function(){var C=window.location.hash;if(C.match(/^#q\|/)){window.location.hash="";if(u!=C){u="";B.call(w,{data:C.replace("#","")})}}};A=window.setInterval("BLOOMBERG.queue._fragmentPoller()",i.poll_interval)};w.init=function(B){$(document).ready(function(){v();if(window.postMessage){if(window.attachEvent){window.attachEvent("onmessage",e,false)}else{window.addEventListener("message",e,false)}}else{s(e)}x();$(window).bind("load",function(){BLOOMBERG.b_persist.init();t(B);m.init();BLOOMBERG.q_ui.init();BLOOMBERG.q_ui.user_options(B)})})};w.refresh_icon=function(B){BLOOMBERG.q_ui.reinit_icons_in_container(B)};function t(B){if(typeof(B)=="undefined"){B={}}i=$.extend(true,i,y,B);var C=i.url.split("/",3);i.origin=C[0]+"//"+C[2]}function x(){BLOOMBERG.user.addResponder("login",r);BLOOMBERG.user.addResponder("logout",c)}function r(){n();BLOOMBERG.q_ui.login()}function c(){m.clear();BLOOMBERG.q_ui.logout()}w.get_items=function(B,E,C,D,F){var G={};G.pagination={page_no:B,per_page:E};if(typeof(C)!="undefined"){G.sort=C}if(typeof(D)!="undefined"){G.filter=D}if(typeof(F)!="undefined"){G.search=F}h({type:"GET",url:BLOOMBERG.global_var.Q_URI+"/items/",data:$.param(G),event_type:"get_items"})};var k=function(C,B){B=JSON.parse(unescape(B));if(!B){return}switch(B.status){case 200:m.reset_sync_dates();m.setup_server_sync(true);break;default:BLOOMBERG.q_ui.handle_errors("merge",B.status);break}};var b=function(G,C){C=JSON.parse(unescape(C));if(!C){return}switch(C.status){case 409:case 201:var B=j.IN_Q;var D=C.item;m.update_single(D,B);BLOOMBERG.q_ui.refresh_option_display(D,B);C.item.unique_id=D.id;C.item.type=D.type;C.item.source=D.source;if(BLOOMBERG.q_ui.get_item_callback!=undefined){BLOOMBERG.q_ui.get_item_callback(D)}break;default:var F=(C.item==undefined)?null:C.item.id;var E=(C.status==undefined)?"":C.status;BLOOMBERG.q_ui.handle_errors("add",E,F);break}};var g=function(E,C){C=JSON.parse(unescape(C));if(!C){return}switch(C.status){case 409:case 200:var D=C.item;var B=m.mark_favorite(D);BLOOMBERG.q_ui.refresh_option_display(D,B);BLOOMBERG.q_ui.activate_star(C.item,B);break;default:BLOOMBERG.q_ui.handle_errors("favorite",C.status);break}};var f=function(E,C){C=JSON.parse(unescape(C));if(!C){return}switch(C.status){case 409:case 200:var D=C.item;var B=m.mark_unfavorite(D);BLOOMBERG.q_ui.refresh_option_display(D,B);BLOOMBERG.q_ui.deactivate_star(C.item,B);break;default:BLOOMBERG.q_ui.handle_errors("unfavorite",C.status);break}};var o=function(E,C){C=JSON.parse(unescape(C));if(!C){return}switch(C.status){case 409:case 200:var D=C.item;var B=m.mark_read(D);break;default:if(BLOOMBERG.q_ui.handle_errors!=undefined){BLOOMBERG.q_ui.handle_errors("read",C.status)}break}};var a=function(E,C){C=JSON.parse(unescape(C));if(!C){return}switch(C.status){case 409:case 200:var D=C.item;var B=m.mark_archived(D);if(BLOOMBERG.q_ui.refresh_option_display!=undefined){BLOOMBERG.q_ui.refresh_option_display(D,B)}if(BLOOMBERG.q_ui.archive_item!=undefined){BLOOMBERG.q_ui.archive_item(D,B)}break;default:BLOOMBERG.q_ui.handle_errors("archive",C.status);break}};w.add_item=function(E,B,G,D){var C={id:G,type:B,source:E};var F={};F.item=C;F.logging_info={context:{path:document.URL,position:D}};h({type:"POST",url:BLOOMBERG.global_var.Q_URI+"/items/",data:$.param(F),event_type:"add"})};w.unfavorite_item=function(F,C,H,E){var D={id:H,type:C,source:F};var B=H;var G={};G.item=D;G.logging_info={context:{path:document.URL,position:E}};h({type:"POST",url:BLOOMBERG.global_var.Q_URI+"/items/unfavorite/",data:$.param(G),event_type:"unfavorite"})};w.favorite_item=function(F,C,H,E){var D={id:H,type:C,source:F};var B=H;var G={};G.item=D;G.logging_info={context:{path:document.URL,position:E}};h({type:"POST",url:BLOOMBERG.global_var.Q_URI+"/items/favorite/",data:$.param(G),event_type:"favorite"})};w.read_item=function(D,B,F){var C={id:F,type:B,source:D};var E={};E.item=C;E.logging_info={context:{path:document.URL}};h({type:"POST",url:BLOOMBERG.global_var.Q_URI+"/items/read/",data:$.param(E),event_type:"read"})};w.archive_item=function(E,B,G,D){var C={id:G,type:B,source:E};var F={};F.item=C;F.logging_info={context:{path:document.URL,position:D}};h({type:"POST",url:BLOOMBERG.global_var.Q_URI+"/items/archive/",data:$.param(F),event_type:"archive"})};w.get_recommendations=function(){var D={};D.logging_info={context:{path:document.URL}};var B=BLOOMBERG.global_var.Q_URI+"/recommendations/";var C=$.param(D);p("GET",B,C,function(E){BLOOMBERG.q_ui.render_suggestion_panel(E)},function(){})};var m=new function(){var O,D,I=this,M="queue_status",J="queue_sync_dates",G=0,S=0,C=(BLOOMBERG.global_var.Q_SYNC_PERIOD||300)*1000,H=(BLOOMBERG.global_var.Q_SYNC_PERIOD_PARTIAL||60)*1000;var R=function(W,V){V=JSON.parse(unescape(V));if(V){switch(V.status){case 200:U(V);sync_interval=C;break;case 206:U(V);sync_interval=H;break;default:}}setTimeout(function(){Q()},sync_interval);function U(Y){var X=Y.items;for(var Z=0;Z<X.length;++Z){X[Z]["status"]=N(X[Z]["status"])}E(X);BLOOMBERG.q_ui.bulk_update(X);B(Y.sync)}};this.init=function(){P();K();L();if(BLOOMBERG.user.logged_in()){I.setup_server_sync(false)}};function P(){var U=l.getItem(M);if(!U){O={};BLOOMBERG.q_ui.render_tutorial()}else{O=JSON.parse(U);BLOOMBERG.q_ui.render_tutorial()}}function N(V){var U;switch(V){case"IN_Q":U=j.IN_Q;break;case"ARCHIVED":U=j.ARCHIVED;break;case"READ":U=j.READ;break;case"FAVORITE":U=j.FAVORITE;break;case"ARCHIVED_FAVORITE":U=j.ARCHIVED_FAVORITE;break;case"READ_FAVORITE":U=j.READ_FAVORITE;break;case"ARCHIVED_READ":U=j.ARCHIVED_READ;break;case"ARCHIVED_READ_FAVORITE":U=j.ARCHIVED_READ_FAVORITE;break;case"NOT_IN_Q":default:U=j.NOT_IN_Q;break}return U}function F(W,V,X,U){if(!O[W]){O[W]={}}if(!O[W][V]){O[W][V]={}}O[W][V][X]=U}function E(V){for(var U=0;U<V.length;++U){F(V[U]["source"],V[U]["type"],V[U]["id"],V[U]["status"])}l.setItem(M,JSON.stringify(O))}function K(){var U=l.getItem(J);if(!U){D={start:G,end:S}}else{D=JSON.parse(U)}}function L(){BLOOMBERG.queue.addResponder("synchronize",R)}this.setup_server_sync=function(V){var W=T(),U=W-D.end;if((U>=C)||V){Q()}else{setTimeout(function(){Q()},C-U)}};function T(){var U=new Date();return U.getTime()+U.getTimezoneOffset()*60*1000}var Q=function(){if(!BLOOMBERG.user.logged_in()){return}var V={},U=C;V.sync=D;h({type:"GET",url:BLOOMBERG.global_var.Q_URI+"/items/synchronize/",data:$.param(V),event_type:"synchronize"})};function B(U){D=U;l.setItem(J,JSON.stringify(D))}this.update_single=function(V,U){F(V.source,V.type,V.id,U);l.setItem(M,JSON.stringify(O))};this.mark_favorite=function(V){var W=I.get_single(V),U;switch(W){case j.IN_Q:U=j.FAVORITE;break;case j.ARCHIVED:U=j.ARCHIVED_FAVORITE;break;case j.READ:U=j.READ_FAVORITE;break;case j.ARCHIVED_READ:U=j.ARCHIVED_READ_FAVORITE;break;case j.FAVORITE:case j.READ_FAVORITE:case j.ARCHIVED_FAVORITE:case j.ARCHIVED_READ_FAVORITE:default:U=W;break}I.update_single(V,U);return U};this.mark_unfavorite=function(V){var W=I.get_single(V),U;switch(W){case j.FAVORITE:U=j.IN_Q;break;case j.READ_FAVORITE:U=j.READ;break;case j.ARCHIVED_FAVORITE:U=j.ARCHIVED;break;case j.ARCHIVED_READ_FAVORITE:U=j.ARCHIVED_READ;break;case j.IN_Q:case j.ARCHIVED:case j.READ:case j.ARCHIVED_READ:default:U=W;break}I.update_single(V,U);return U};this.mark_read=function(V){var W=I.get_single(V),U;switch(W){case j.IN_Q:U=j.READ;break;case j.ARCHIVED:U=j.ARCHIVED_READ;break;case j.FAVORITE:U=j.READ_FAVORITE;break;case j.ARCHIVED_FAVORITE:U=j.ARCHIVED_READ_FAVORITE;break;case j.READ:case j.READ_FAVORITE:case j.ARCHIVED_READ:case j.ARCHIVED_READ_FAVORITE:default:U=W;break}I.update_single(V,U);return U};this.mark_archived=function(V){var W=I.get_single(V),U;switch(W){case j.IN_Q:U=j.ARCHIVED;break;case j.READ:U=j.ARCHIVED_READ;break;case j.FAVORITE:U=j.ARCHIVED_FAVORITE;break;case j.READ_FAVORITE:U=j.ARCHIVED_READ_FAVORITE;break;case j.ARCHIVED:case j.ARCHIVED_FAVORITE:case j.ARCHIVED_READ:case j.ARCHIVED_READ_FAVORITE:default:U=W;break}I.update_single(V,U);return U};this.bulk_update=function(V,U){for(var W=0;W<V.length;++W){F(V[W]["source"],V[W]["type"],V[W]["id"],U)}l.setItem(M,JSON.stringify(O))};this.get_single=function(W){var X=W.source,V=W.type,Y=W.id,U;if(O[X]){if(O[X][V]){U=O[X][V][Y]}}if(!U){U=j.NOT_IN_Q}return U};this.clear=function(){O={};l.removeItem(M);I.reset_sync_dates()};this.reset_sync_dates=function(){D={start:G,end:S};l.removeItem(J)}};w.get_item_status=function(B){return m.get_single(B)};var l=new function(){this.getItem=function(B){return BLOOMBERG.b_persist.get(B)};this.setItem=function(B,C){BLOOMBERG.b_persist.set(B,C)};this.removeItem=function(B){BLOOMBERG.b_persist.remove(B)}};function n(){var B={};B.logging_info={context:{path:document.URL}};h({type:"POST",url:BLOOMBERG.global_var.Q_URI+"/merge/",data:$.param(B),event_type:"merge"})}})();if(typeof BLOOMBERG==="undefined"||!BLOOMBERG){var BLOOMBERG={};(function(){BLOOMBERG.namespace=function(b){var a=[],d,c;a=b.split(".");d=BLOOMBERG;if(a[0]==="BLOOMBERG"){a.shift()}for(c=0;c<a.length;c++){if(typeof d[a[c]]==="undefined"){d[a[c]]={}}d=d[a[c]]}return d}})()}(function(){var i=BLOOMBERG.namespace("q_ui");var d=BLOOMBERG.queue.STATUS;var a=typeof(window.postMessage)!=="undefined"?10:5;i.story_icon_selectors=["#story_meta .in_q","#story_tools_bottom .in_q",".bview_story_meta .in_q","#bloomberg_vod_player h1 .in_q"];i.story_page_selector="#story";i.video_page_selector="#bloomberg_vod_player";i.mini_q_elem={};i.gup=function(k){k=k.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var j="[\\?&]"+k+"=([^&#]*)";var m=new RegExp(j);var l=m.exec(window.location.href);if(l==null){return""}else{return l[1]}};i.icon_generator=function(l,j){var k="";switch(j){case"IN_Q":k="<div class=\"q_style_button in_q\" title='In queue'>Q</div>";break;case"ARCHIVED":case"ARCHIVED_READ":k="<div class=\"q_style_button in_q archived_in_q\" title='Archived' >Q</div>";break;case"READ":k="<div class=\"q_style_button in_q read_in_q\" title='In queue'>Q</div>";break;case"FAVORITE":k="<div  class=\"q_style_button in_q in_q_favorite\" title='In queue'>Q</div>";break;case"ARCHIVED_FAVORITE":case"ARCHIVED_READ_FAVORITE":k="<div class=\"q_style_button in_q archived_in_q archived_favorite\" title='Archived'>Q</div>";break;case"READ_FAVORITE":k="<div class=\"q_style_button in_q in_q read_in_q in_q_favorite\" title='In queue'>Q</div>";break;case"NOT_IN_Q":default:k="<div class=\"q_style_button add_to_q\" title='Add to queue'>Q</div>";break}return k};i.user_opts={};i.user_options=function(j){i.user_opts=j};i.init_ajax_listener=function(){$("body").ajaxComplete(function(k,l,j){if(l!=undefined){if(l.responseText!=undefined&&l.responseText.search("href")>0){i.icon_init()}}})};i.get_item_callback=function(k){if($("#q_dashboard").size()<=0){$("#mini_q_welcome_message").hide();i.render_mini_q_item(k,false)}else{if($("#q_unread_button").hasClass("active")||$("#q_all_button").hasClass("active")){i.add_to_dashboard(k);var j=new RegExp(/[()]/);l=parseFloat($("#q_dashboard_header_text strong").text().replace(j,""))+1;$("#q_dashboard_header_text strong").text("("+l+")")}else{var l=parseFloat($("#q_unread_button #new_count").text())+1;$("#q_unread_button #new_count").show();$("#q_unread_button #new_count").text(l)}}i.check_and_remove_from_suggestions(k)};i.add_to_dashboard=function(u){var k=(u.thumbnail_url!=null)?'<img src="'+u.thumbnail_url+'" />':"";var m=(u.created_at==null||u.created_at==undefined)?u.added_at:u.created_at;var t=i.generate_time(m,false);var j=new Date(m);var p=new Date();p.setDate(j.getDate()+30);p=p.toUTCString();var o=i.generate_time(p,true);var l=(u.is_favorite)?"active_star_item":"";var v=(u.is_archived)?"":"&bull; Auto-archives in "+o+' &bull; <a href="javascript:;" data-unique-id="'+u.unique_id+'" data-type="'+u.type+'" data-source="'+u.source+'"  onclick="BLOOMBERG.q_ui.archive_from_q_dashboard($(this))">Archive</a>';var r=($(".q_dashboard_row").size()<=0)?"last":" ";var n='<div class="q_dashboard_row '+r+'"><div class="q_dashboard_check"><input type="checkbox" /></div><div class="q_dashboard_thumbnail">'+k+'</div><div class="q_dashboard_info"><h2><a href="'+u.url+'">'+u.headline+"</a></h2><p>"+i.translate_source(u.source)+" &bull; Added "+t+" ago"+v+'</p><a class="star_q_item '+l+'"  data-unique-id="'+u.unique_id+'" data-type="'+u.type+'" data-source="'+u.source+'"></a></div><div class="clear"></div></div>';if(!$("#q_dashboard_show_more").hasClass("inactive")&&$("#q_dashboard_show_more").size()>0){$(".q_dashboard_row:last").remove()}else{var s=(parseInt($("#number_of_items_number").text())+1);$("#number_of_items_number").text(s)}$("#q_dashboard_rows").prepend(n);var q='.suggested_q_item[data-id="'+u.id+'"]';$(q).slideUp("fast",function(){$(this).remove();if($(".suggested_q_item").size()>4){}else{$(".suggested_q_item .last").removeClass("last");$(".suggested_q_item:last").addClass("last");var w=$("#q_suggestion_rows").outerHeight()-61;w=w+"px";$("#q_suggestion_rows").css("height",w)}})};i.get_items_callback=function(l,m){m=JSON.parse(unescape(m));if(m.status!=200){return}var t=m.items;var n=t.length;if(!i.on_dashboard_page()){$("#items_in_q .q_item").html("").addClass("loading");for(var p=0;p<n;p++){i.render_mini_q_item(t[p],true)}if(n==0){var j=$("#items_in_q");var q='<div class="q_item first empty_q"><a href="'+BLOOMBERG.global_var.Q_DASHBOARD_PAGE+'#all" class="q_headline">You have read all the items in your Queue.</a><div class="q_item_actions"><a href="'+BLOOMBERG.global_var.Q_DASHBOARD_PAGE+'#all">Click here to view your full Queue.</a></div></div>';$(j).find(".q_item:last").remove();$(j).find(".q_item:first").before(q).removeClass("first");$(j).find(".q_item:last").hide();i.resize_msie_shadow()}}$("#items_in_q .loading").removeClass("loading");var k=parseInt(m.page_num);if($("#q_suggested_items_panel").size()>0){BLOOMBERG.queue.get_recommendations()}if($("#q_dashboard").size()<=0){if(i.on_dashboard_page()&&k==1){i.render_dashboard(m,"#q_dashboard_page")}}else{i.add_dashboard_items(m)}$("#q_dashboard_header_text strong").text("("+m.total_matches+")");var s=Math.ceil(parseInt(m.total_matches)/a);$("#q_dashboard").attr("data-total-pages",s);$("#q_dashboard_rows").removeClass("loading");if(parseInt($("#q_dashboard").attr("data-total-pages"))==parseInt(m.page_num)){var o=$(".q_dashboard_row").size();var r=(o>1)?"items":"item";var u=(o>1)?"all":"";$("#q_dashboard_show_more").fadeTo("fast",0.25).html("Showing "+u+' <span id="number_of_items_number">'+o+"</span> "+r+".").addClass("inactive")}else{$("#q_dashboard_show_more").fadeTo("fast",1).text("Show More").removeClass("inactive")}};i.render_mini_q_item=function(r,l){var q=(r.created_at)?r.created_at:r.added_at;i.expose_mini_q();if($(i.mini_q_elem).hasClass("closed")){i.pulse_mini_q()}var j=$("#items_in_q");var p=new Date();var m=(l)?"":'<div class="pulser"></div>';var k=(l)?"":"q_pulsing";var n=(r.is_favorite)?"active_star_item":"";var o='<div class="q_item first '+k+'">'+m+'<a href="'+r.url+'" class="q_headline">'+r.headline+'</a><div class="q_item_actions"><a class="star_q_item '+n+'"  data-unique-id="'+r.unique_id+'" data-type="'+r.type+'" data-source="'+r.source+'"></a><span class="timestamp" data-timestamp="'+p+'" >Added '+i.generate_time(q,false)+' ago </span> &bull; <a href="javascript:;" data-unique-id="'+r.unique_id+'" data-source="'+r.source+'" data-type="'+r.type+'" onclick="BLOOMBERG.q_ui.archive_from_mini_q($(this))">Archive</a></div></div>';$(j).find(".q_item").removeClass("not_last");if(l){$(j).find(".loading:first").replaceWith(o);$(j).find(".q_item:last").removeClass("first")}else{$(j).find(".q_item:last").remove();$(j).find(".q_item:first").before(o).removeClass("first")}hide_empty_mini_q_item();$(".empty_q").html("").removeClass("empty_q");$(".q_pulsing").fadeIn(600,function(){$(this).removeClass("q_pulsing");$(".pulser").show().fadeOut(600,function(){$(".pulser").remove()})});i.resize_msie_shadow()};function g(k,j){if(BLOOMBERG.tracker&&BLOOMBERG.tracker.EVENTTRACK&&BLOOMBERG.tracker.EVENTTRACK.record){BLOOMBERG.tracker.EVENTTRACK.record("Queue Tracking",k,j)}}i.archive_from_mini_q=function(m){var j=i.track_position($(m));var n=$(m).attr("data-unique-id");var l=$(m).attr("data-source");var k=$(m).attr("data-type");BLOOMBERG.queue.archive_item(l,k,n,j);g("event15");$(m).parents(".q_item").addClass("loading").html("");i.resize_msie_shadow()};i.archive_from_q_dashboard=function(m){var j=i.track_position($(m));var n=$(m).attr("data-unique-id");var l=$(m).attr("data-source");var k=$(m).attr("data-type");BLOOMBERG.queue.archive_item(l,k,n,j);g("event33");$("#q_dashboard_rows").addClass("loading").html("")};i.archive_item=function(m,k){if($("#q_dashboard").size()>0){var n=$.trim($("#q_dashboard_search_input").val().replace(/(<([^>]+)>)/ig,""));var l=$("#q_dashboard").attr("data-filter");var j=$("#q_dashboard").attr("data-sort");if(n=="Search Your Bloomberg Queue"||n==""){i.load_dashboard_page(1,j,l)}else{BLOOMBERG.queue.get_items(1,a,j,"all",n)}}else{BLOOMBERG.queue.get_items(1,2,"add","unread")}};i.pulse_mini_q=function(j){$("#mini_q_tab").prepend('<div id="tab_flasher"></div>').addClass("flashing");$("#tab_flasher").fadeIn(200).delay(200).fadeOut(200,function(){$(this).remove();$("#mini_q_tab").removeClass("flashing")})};i.toggle_mini_q=function(j){j.preventDefault();if($(i.mini_q_elem).hasClass("closed")){i.open_mini_q(null)}else{i.close_mini_q()}};i.run_msie_re_size=function(){var j=$("#mini_q_container").outerHeight();$("#ie_drop_shadow").height(j)};i.resize_msie_shadow=function(){if($.browser.msie){setTimeout("BLOOMBERG.q_ui.run_msie_re_size()",15)}};i.handle_errors=function(m,l,k){if(k!=null){var j='a[data-id="'+k+'"]';$(j).siblings(".q_style_button").fadeTo(25,1).addClass("erred").attr("title","Sorry, there was a technical difficulty in adding this item to your Q. Please try again later. Code: "+l+" Event: "+m)}};i.user_has_items_in_their_queue=function(){return(BLOOMBERG.b_persist.get("queue_status")!=null&&BLOOMBERG.b_persist.get("queue_status")!={})};i.open_mini_q=function(j){i.destroy_tutorial("1");if(i.user_tutorial_status()>2||(i.user_has_items_in_their_queue())){$("#mini_q_welcome_message").hide();if($("#items_in_q .loading").size()>0||$("#mini_q").attr("data-reload")=="true"){BLOOMBERG.queue.get_items(1,2,"add","unread");i.mini_q_timed_out=false;$("#mini_q").attr("data-reload","false");setTimeout("$('#mini_q').attr('data-reload','true')",300000)}}else{$("#mini_q_welcome_message").show();$("#items_in_q .q_item").hide()}if($("#suggested_items_in_q .loading").size()>0||$("#mini_q").attr("data-reload")=="true"){BLOOMBERG.queue.get_recommendations()}$(i.mini_q_elem).animate({right:"0px"},250,function(){$(i.mini_q_elem).removeClass("closed");if(j){j()}})};i.close_mini_q=function(j){$(i.mini_q_elem).animate({right:"-235px"},250,function(){$("#mini_q_suggestion_notifier").hide();$(i.mini_q_elem).addClass("closed");if(j){j()}})};i.logout=function(){$("#mini_q").remove();$(".q_style_button").remove();$("#q_dashboard").remove();$("#q_suggested_items_panel").html("");BLOOMBERG.b_persist.remove("user_tutorial_status");if(!i.on_dashboard_page()){i.close_mini_q()}i.mini_q_timed_out=true;i.alreadyLoaded=false;setTimeout("BLOOMBERG.q_ui.init()",1000)};i.login=function(){$("#mini_q").remove();$(".q_style_button").remove();$("#q_dashboard").remove();$("#q_suggested_items_panel").html("");if(!i.on_dashboard_page()){i.close_mini_q()}i.mini_q_timed_out=true;i.alreadyLoaded=false;setTimeout("BLOOMBERG.q_ui.init()",1000)};i.render_tutorial=function(){var k=i.user_tutorial_status();if(i.on_dashboard_page()){if(k<2){var j='<div id="q_dashboard_tutorial"><a href="javascript:;" id="close_dash_tutorial" onclick="BLOOMBERG.q_ui.destroy_tutorial(\'2\')" class="close">x</a><div class="q_dashboard_tutorial_text_holder"><h5>What\'s the queue?</h5><h6>The Bloomberg Queue is a new way to get all the news that matters to you</h6><ul><li><strong>Your queue helps you find the news that matters to you</strong><p>Discover news that is related to your interests with Bloomberg.com\'s suggestions.</p></li><li><strong>Read what you want - when you want</strong><p>The Bloomberg Queue helps you save news on Bloomberg.com, so you can easily find it later.</p></li><li><strong>Take the news with you</strong><p>Read the stories you\'ve saved on any computer or your tablet browser.</p></li><a href="javascript:;" id="need_more" class="faq_link">Need more? Go step-by-step with our Bloomberg Queue FAQ</a></div></div>';$("#q_dashboard_page").before(j)}}else{if(k<1){BLOOMBERG.q_ui.destroy_tutorial("1")}}};i.destroy_tutorial=function(j){$("#do_you_q").remove();$("#q_dashboard_tutorial").remove();i.set_user_tutorial_status(j)};i.render_faq_link=function(){$("#how_does_the_q_work").remove();$("#q_suggested_items_panel").before('<a href="javascript:;" id="how_does_the_q_work" class="faq_link">How does the Bloomberg Queue work?</a>')};i.render_tut_button=function(){if(!i.on_dashboard_page()){$("#nav_try_link").remove();$("#utility_navigation").after('<a href="'+BLOOMBERG.global_var.Q_DASHBOARD_PAGE+'" class="" id="nav_try_link"></a>')}};i.render_mini_q=function(){var j='<div id="mini_q" class="closed"><a href="#" id="mini_q_tab">Q</a><div id="ie_drop_shadow"></div><div id="mini_q_container"><span class="q_head"><a href="javascript:;" id="close_q" onclick="BLOOMBERG.q_ui.close_mini_q();"></a><a href="javascript:;" class="faq_link q_action">What is the queue?</a></span><div id="items_in_q" class="mini_q_section rounded_top"><div class="mini_q_section_top rounded_top"><a href="'+BLOOMBERG.global_var.Q_DASHBOARD_PAGE+'" class="q_action">More &raquo;</a>Items In Your queue</div><div id="mini_q_welcome_message"><h3>This is your Bloomberg Queue</h3><p>The queue will help you find news, save stories for later and take them with you</p><div class="action_buttons"><a href="'+BLOOMBERG.global_var.Q_DASHBOARD_PAGE+'" class="" id="learn_more">Learn More</a><a href="javascript:;" onclick="BLOOMBERG.q_ui.close_mini_q();">Close</a><div style="clear:both;"></div></div></div><div class="q_item first loading"></div><div class="q_item loading"></div></div><div id="suggested_items_in_q" class="mini_q_section rounded_top"><div class="mini_q_section_top rounded_top"><a href="'+BLOOMBERG.global_var.Q_DASHBOARD_PAGE+'" class="q_action">More &raquo;</a>  New Suggestions</div><div class="q_item first loading"></div><div class="q_item loading"></div></div></div></div>';$("body").append(j);i.mini_q_elem=$("#mini_q");if($(window).height()<700){$("#mini_q").css("top","140px");$("#do_you_q").css("top","160px")}$("a#mini_q_tab").bind("click",i.toggle_mini_q)};i.user_tutorial_status=function(){var k=BLOOMBERG.b_persist.get("user_tutorial_status");var j=(!k)?0:k;return parseFloat(j)};i.set_user_tutorial_status=function(k){var m=BLOOMBERG.b_persist.get("user_tutorial_status");var l=(!m)?0:m;var j=parseFloat(k);if(j>l){BLOOMBERG.b_persist.set("user_tutorial_status",j)}};i.alreadyLoaded=false;i.init=function(){i.icon_init();$(window).bind("scroll",function(){if(!i.on_dashboard_page()){BLOOMBERG.q_ui.destroy_tutorial("1")}});if(i.on_story_page()){var p=i.story_page_selector+" a.q:first";if($(i.video_page_selector).size()>0){p=i.video_page_selector+" a.q:first"}var q=$(p).attr("data-type");var k=$(p).attr("data-id");var j=BLOOMBERG.global_var.Q_LINK_SOURCE;var r={source:j,type:q,id:k};var n=BLOOMBERG.queue.get_item_status(r);if(n==d.IN_Q||n==d.ARCHIVED||n==d.FAVORITE||n==d.ARCHIVED_FAVORITE){setTimeout("BLOOMBERG.q_ui.trigger_read()",15000)}}if(!i.alreadyLoaded){i.mini_q_timed_out=true;i.alreadyLoaded=true;h();c()}if(!i.on_dashboard_page()){i.render_mini_q()}setInterval("BLOOMBERG.q_ui.timestamp_sweeper()",60000);i.init_ajax_listener();var l;var o=window.location.hash;switch(o){case"#read":l="read";break;case"#favorite":l="favorite";break;case"#archived":l="archived";break;case"#all":l="all";break;default:l="unread"}if(i.on_dashboard_page()){if(o.indexOf("search")>0){var m=o.split("|");l=$("#q_dashboard").attr("data-filter");BLOOMBERG.queue.get_items(1,a,"add",l,m[1])}else{i.load_dashboard_page(1,"add",l)}}i.render_faq_link()};i.load_dashboard_page=function(l,j,k){BLOOMBERG.queue.get_items(l,a,j,k)};i.activate_star=function(l,k){var j='.star_q_item[data-unique-id="'+l.id+'"]';$(j).addClass("active_star_item")};i.deactivate_star=function(l,k){var j='.star_q_item[data-unique-id="'+l.id+'"]';$(j).removeClass("active_star_item")};function f(j){return($(j).parents(".social_toolbar").length!=0)}function h(){$(".faq_link").live("click",function(l){l.preventDefault();BLOOMBERG.q_ui.set_user_tutorial_status("3");var k=BLOOMBERG.q_ui.user_opts.url+"/faq";window.location.href=k});$(".add_to_q").live("click",function(q){i.destroy_tutorial("3");if($("#q_unread_button").hasClass("active")||$("#q_all_button").hasClass("active")){$("#no_text_header").remove()}var l=i.track_click(q,$(this));var p=$(this).siblings(".q").attr("data-id");var k=$(this).siblings(".q").attr("data-type");var o=(p==undefined||p==null||p=="")?$(this).siblings(".q").attr("href"):p;var n=(k==undefined||k==null||k=="")?"UK":k;$(this).fadeTo(25,0.5);BLOOMBERG.queue.add_item(BLOOMBERG.global_var.Q_LINK_SOURCE,n,o,l);var m=$(this).hasClass("from_suggested");if(m){if($(this).siblings(".q_headline").length!=0){g("event16")}else{g("event34")}}else{if(f(this)){g("event37")}else{g("event12")}}if(i.on_story_page()){setTimeout("BLOOMBERG.q_ui.trigger_read()",15000)}});$(".star_q_item").live("click",function(n){n.preventDefault();var k=i.track_click(n,$(this));var o=$(this).attr("data-unique-id");var l=$(this).attr("data-type");var m=BLOOMBERG.global_var.Q_LINK_SOURCE;if($(this).hasClass("active_star_item")){BLOOMBERG.queue.unfavorite_item(m,l,o,k);if(!i.on_dashboard_page()){g("event27")}else{g("event36")}}else{BLOOMBERG.queue.favorite_item(m,l,o,k);if(!i.on_dashboard_page()){g("event14")}else{g("event32")}}});$(".q_headline").live("mousedown",function(l){var k=($(this).siblings(".from_suggested").length!=0);if(k){g("event17")}else{g("event13")}});$(".q_dashboard_info h2 a").live("mousedown",function(){g("event31")});$(".suggested_q_headline").live("mousedown",function(){g("event35")});var j=function(n){n.preventDefault();$(this).fadeTo(25,0.5);var k=i.track_click(n,$(this));var o=$(this).siblings("a.q").attr("data-id");var l=$(this).siblings("a.q").attr("data-type");var m=BLOOMBERG.global_var.Q_LINK_SOURCE;if($(this).hasClass("in_q_favorite")||$(this).hasClass("archived_favorite")||$(this).hasClass("read_favorite")){BLOOMBERG.queue.unfavorite_item(m,l,o,k)}else{BLOOMBERG.queue.favorite_item(m,l,o,k)}};$.each(BLOOMBERG.q_ui.story_icon_selectors,function(k,l){$(l).live("click",j)})}function c(){BLOOMBERG.queue.addResponder("get_items",BLOOMBERG.q_ui.get_items_callback)}i.refresh_option_display=function(n,j){if(n.id==undefined){return false}var m;var o=(n.id.indexOf("/")>-1)?'a[href="'+n.id+'"].q':'a[data-id="'+n.id+'"].q';$(o).siblings(".q_style_button").remove();var l="";switch(j){case d.IN_Q:l="IN_Q";break;case d.ARCHIVED:l="ARCHIVED";break;case d.READ:l="READ";break;case d.FAVORITE:l="FAVORITE";break;case d.ARCHIVED_FAVORITE:l="ARCHIVED_FAVORITE";break;case d.READ_FAVORITE:l="READ_FAVORITE";break;case d.ARCHIVED_READ:l="ARCHIVED_READ";break;case d.ARCHIVED_READ_FAVORITE:l="ARCHIVED_READ_FAVORITE";break;case d.NOT_IN_Q:default:l="NOT_IN_Q";break}m=i.icon_generator(n.id,l);$(o).after(m);var k='a[data-id="'+n.id+'"]';$(k).siblings(".q_style_button").fadeTo(25,1)};i.on_story_page=function(){return(($(i.story_page_selector).size()>0)||($(i.video_page_selector).size()>0))};function b(l){var l=$(l);var m=(l.attr("data-type")==undefined||l.attr("data-type")==null||l.attr("data-type")=="")?"UK":l.attr("data-type");var j=(l.attr("data-id")==undefined||l.attr("data-id")==null||l.attr("data-id")=="")?l.attr("href"):l.attr("data-id");var k={source:BLOOMBERG.global_var.Q_LINK_SOURCE,type:m,id:j};i.refresh_option_display(k,BLOOMBERG.queue.get_item_status(k))}i.icon_init=function(){e($(".q"))};function e(l){if(l.length<=0){return}var m=100;var j=l.splice(0,m);for(var k=0;k<j.length;++k){b($(j[k]))}setTimeout(function(){e(l)},10)}i.reinit_icons_in_container=function(j){$(j).find("a.q").each(function(){b($(this))})};i.expose_mini_q=function(j){setTimeout("$('#mini_q').show();",500)};i.timestamp_sweeper=function(){$(i.mini_q_elem).find("span.timestamp").each(function(){})};i.generate_time=function(s,p){var k=new Date();var j=new Date(s);var l=(p)?j-k:k-j;var r;var m=Math.floor(l/60000);var t=Math.floor(m/60);var u=Math.floor(t/24);if(u>0){var o=(u>1)?"days":"day";r=u+" "+o}else{if(t>0){var n=(t>1)?"hours":"hour";r=t+" "+n}else{if(m>0){var q=(m>1)?"minutes":"minute";r=m+" "+q}else{r="1 minute"}}}return r};i.on_dashboard_page=function(){return($("#q_dashboard_page").size()>0)};i.translate_source=function(j){var k;switch(j){case"BB":k="Bloomberg";break;default:k="Bloomberg"}return k};i.change_dashboard_sort_order=function(j){$("#q_dashboard_rows").html("");$("#q_dashboard_rows").addClass("loading");$("#q_dashboard_show_more").text("");$("#q_dashboard").attr("data-sort",j);var k=$("#q_dashboard").attr("data-filter");$("#q_dashboard").attr("data-pages-loaded","1");var l=$.trim($("#q_dashboard_search_input").val().replace(/(<([^>]+)>)/ig,""));if(l=="Search Your Bloomberg Queue"||l==""){i.load_dashboard_page(1,j,k)}else{BLOOMBERG.queue.get_items(1,a,j,"all",l)}if(j==="relevance"){g("event45")}else{if(j==="publish"){g("event46")}else{if(j==="added"){g("event47")}}}};i.change_dashboard_filter_option=function(k){$("#q_dashboard_rows").html("");$("#q_dashboard_rows").addClass("loading");$("#q_dashboard_show_more").text("");$("#q_dashboard").attr("data-filter",k);$("#q_dashboard").attr("data-pages-loaded","1");var j=$("#q_dashboard").attr("data-sort");var l=$.trim($("#q_dashboard_search_input").val().replace(/(<([^>]+)>)/ig,""));if(l=="Search Your Bloomberg Queue"||l==""){i.load_dashboard_page(1,j,k)}else{BLOOMBERG.queue.get_items(1,a,j,k,l)}if(k==="unread"){g("event40")}else{if(k==="read"){g("event41")}else{if(k==="favorite"){g("event42")}else{if(k==="all"){g("event43")}else{if(k==="archived"){g("event44")}}}}}};i.add_dashboard_items=function(A,u){var x="";var r=A.items.length;var j=window.location.hash;var o=A.is_search;$("#q_dashboard_rows .last").removeClass("last");for(var w=0;w<r;w++){var p=(A.items[w].thumbnail_url!=null)?'<img src="'+A.items[w].thumbnail_url+'" />':"";var n=i.generate_time(A.items[w].created_at,false);var k=new Date(A.items[w].created_at);var q=new Date();q.setDate(k.getDate()+30);q=q.toUTCString();var z=(w==(r-1))?"last":" ";var y=i.generate_time(q,true);var t=(A.items[w].is_favorite)?"active_star_item":"";var s=(A.items[w].is_archived)?"":"&bull; Auto-archives in "+y+' &bull; <a href="javascript:;" data-unique-id="'+A.items[w].unique_id+'" data-type="'+A.items[w].type+'" data-source="'+A.items[w].source+'"  onclick="BLOOMBERG.q_ui.archive_from_q_dashboard($(this))">Archive</a>';x+='<div class="q_dashboard_row '+z+'"><div class="q_dashboard_check"><input type="checkbox" /></div><div class="q_dashboard_thumbnail">'+p+'</div><div class="q_dashboard_info"><h2><a href="'+A.items[w].url+'">'+A.items[w].headline+"</a></h2><p>"+i.translate_source(A.items[w].source)+" &bull; Added "+n+" ago "+s+'</p><a class="star_q_item '+t+'"  data-unique-id="'+A.items[w].unique_id+'" data-type="'+A.items[w].type+'" data-source="'+A.items[w].source+'"></a></div><div class="clear"></div></div>'}if(r==0){var l;if(o){var v=$.trim($("#q_dashboard_search_input").val().replace(/(<([^>]+)>)/ig,""));l=(A.filter.toLowerCase()=="all")?"":A.filter;x+='<div class="q_dashboard_row last"><div class="q_dashboard_info"><h2>Your search for  <em>'+v+"</em> returned no "+l+" items from your queue.</h2></div></div>"}else{l=(A.filter.toLowerCase()=="all")?"There are no items in your queue.":"There are no "+A.filter+" items in your queue.";x+='<div id="no_text_header" class="q_dashboard_row last"><div class="q_dashboard_info"><h2>'+l+"</h2></div></div>"}}if(A.page_num==1){$("#q_dashboard_rows").html("")}$("#q_dashboard_rows").append(x);var m=Math.ceil(parseInt(A.total_matches)/a);$("#q_dashboard").attr("data-total-pages",m);if(parseInt($("#q_dashboard").attr("data-total-pages"))>1){i.initialize_more_action()}else{$("#q_dashboard_show_more").remove()}if(o){}};i.initialize_more_action=function(){var j=function(){var r=$("#q_dashboard_show_more").offset();if(((r.top-$(window).height()-$(window).scrollTop())<5)){if($("#q_dashboard").attr("data-pages-loaded",m)<parseInt($("#q_dashboard").attr("data-total-pages"))){var m=parseInt($("#q_dashboard").attr("data-pages-loaded"))+1;var l=$("#q_dashboard").attr("data-sort");$("#q_dashboard").attr("data-pages-loaded",m);var p=$("#q_dashboard").attr("data-filter");i.load_dashboard_page(m,l,p)}else{var q=$(".q_dashboard_row").size();var o=(q>1)?"items":"item";var n=(q>1)?"all":"";$("#q_dashboard_show_more").fadeTo("fast",0.25).text("Showing "+n+' <span id="number_of_items_number">'+q+"</span> "+o+".").addClass("inactive")}}};var k=function(o){o.preventDefault();if($("#q_dashboard").attr("data-pages-loaded",m)<parseInt($("#q_dashboard").attr("data-total-pages"))){var m=parseInt($("#q_dashboard").attr("data-pages-loaded"))+1;var l=$("#q_dashboard").attr("data-sort");$("#q_dashboard").attr("data-pages-loaded",m);var n=$("#q_dashboard").attr("data-filter");i.load_dashboard_page(m,l,n)}};if($("#q_dashboard_show_more").size()==0){$("#q_dashboard").after('<div id="q_dashboard_show_more" class="active">Show More</div>')}$("#q_dashboard_show_more").bind("click",k)};i.render_dashboard=function(o,m){var s=function(B){$("#q_dashboard_search_button").hide();$("#q_dashboard_cancel_button").show();if($("#q_dashboard").attr("data-first-search")=="true"){$("#q_dashboard").attr("data-sort","relevance");$("em.button_text").text("Relevance");$("#relevance_sort_option").show()}var y=$.trim($("#q_dashboard_search_input").val().replace(/(<([^>]+)>)/ig,""));if(y==""||y=="Search Your Bloomberg Queue"){$("#q_dashboard_search_input").trigger("blur");return false}$("#q_dashboard_rows").html("").addClass("loading");B.preventDefault();$(".q_dashboard_filter_button").removeClass("active");var A=($("#q_dashboard").attr("data-first-search")=="true")?"all":$("#q_dashboard").attr("data-filter");var z=($("#q_dashboard").attr("data-first-search")=="true")?"relevance":$("#q_dashboard").attr("data-sort");$("#q_dashboard").attr("data-first-search","false");window.location.hash="#"+A+"-search|"+y;BLOOMBERG.queue.get_items(1,a,z,A,y);g("event28")};var l=function(){var A=window.location.hash;var z="Search Your Bloomberg Queue";if(A.indexOf("search")>=0){var y=A.split("|");z=y[1]}return z};var v=(o.filter=="unread")?"active":"";var r=(o.filter=="read")?"active":"";var k=(o.filter=="favorite")?"active":"";var w=(o.filter=="archived")?"active":"";var x=(o.filter=="all")?"active":"";var t=Math.ceil(parseInt(o.total_matches)/a);var j=(o.is_search)?"Relevance":"Date Added";var n=(o.is_search)?";":"display:none;";var u=(o.is_search)?"display:none;":"";var q=($.browser.msie)?'<xml:namespace ns="urn:schemas-microsoft-com:vml" prefix="v" /><v:roundrect class="new_count_ie_style" fillcolor="red" color="white" arcsize="8px" StrokeColor="#9B9B9B" id="new_count">0</v:roundrect>':'<div id="new_count">0</div>';var p='<div id="q_dashboard" data-pages-loaded="1" data-total-pages="'+t+'" data-sort="add" data-first-search="true" data-filter="'+o.filter+'"><div id="q_dashboard_header"><div id="q_dashboard_header_text">Items In Your Queue <strong>('+o.total_matches+')</strong></div><a href="#" class="q_button" id="q_dashboard_search_settings_button">Settings</a><div id="q_dashboard_menu"><ul><li id="q_unread_button" class="q_dashboard_filter_button first '+v+'"><a href="#unread">Unread</a>'+q+'</li><li id="q_read_button" class="q_dashboard_filter_button '+r+'"><a href="#read">Read</a></li><li id="q_starred_button" class="q_dashboard_filter_button '+k+'"><a href="#favorite">Starred</a></li><li id="q_all_button" class="q_dashboard_filter_button '+x+'"><a href="#all">All</a></li><li id="q_archive_button" class="q_dashboard_filter_button '+w+' last"><a href="#archived">Archive</a></li></ul></div></div><div id="q_dashboard_search"><form action="" id="q_dashboard_search_form"><input type="text" id="q_dashboard_search_input" value="'+l()+'" /><input type="submit" id="q_dashboard_search_button" value="Search" style="'+u+'" class="q_button" /><a href="'+BLOOMBERG.global_var.Q_DASHBOARD_PAGE+'" class="q_button" style="'+n+'" id="q_dashboard_cancel_button">Cancel</a></form></div><div id="q_dashboard_grid"><div id="q_dashboard_grid_header"><div id="q_dashboard_batch_check"><input type="checkbox" name="q_dashboard_select_all" id="q_dashboard_select_all" /></div><div id="q_dashboard_batch_buttons"><div class="q_button menu_button"><em class="button_text">'+j+'</em><span><ul><li id="relevance_sort_option"><a href="javascript:;" data-sort-by="relevance">Relevance</a></li><li><a href="javascript:;" data-sort-by="publish">Date Published</a></li><li><a href="javascript:;" data-sort-by="added">Date Added</a></li></ul></span></div><div id="sort_by_label">Sort By: </div><a href="javascript:;" class="q_button">Archive</a><a href="javascript:;" class="q_button">Mark as Read</a><a href="javascript:;" class="q_button">Star</a><a href="javascript:;" class="q_button">Email</a></div></div><div id="q_dashboard_rows"></div></div></div>';$(m).html(p);i.add_dashboard_items(o);$("#q_dashboard_search_input").bind("focus",function(){if($(this).val()=="Search Your Bloomberg Queue"){$(this).val("")}});$("#q_dashboard_search_input").bind("blur",function(){if($(this).val()==""){$(this).val("Search Your Bloomberg Queue")}});$(".menu_button em").bind("click",function(z){z.preventDefault();z.stopPropagation();$(this).parents(".menu_button").addClass("open");var y=$(this).parents(".menu_button").outerWidth()+15;$(this).parents(".menu_button").find("span").css("min-width",y)});$(".menu_button .top_level").bind("click",function(y){y.preventDefault();$(this).parents(".menu_button").removeClass("open")});$(".menu_button ul li a").not(".top_level").bind("click",function(z){z.preventDefault();$(this).parents(".menu_button").removeClass("open");$(this).parents(".menu_button").find(".button_text").text($(this).text());var y=$(this).attr("data-sort-by");i.change_dashboard_sort_order(y)});$("form#q_dashboard_search_form").bind("submit",s);$(".q_dashboard_filter_button a").bind("click",function(C){C.preventDefault();var A=window.location.hash;var D=$(this).attr("href");var z=D.split("#");var B=z[1];if(B=="unread"){$(this).siblings("#new_count").hide().text("0")}if(A.indexOf("search")>-1){var y=A.split("|");window.location.hash="#"+B+"-search|"+y[1]}else{window.location.hash="#"+B}$("#q_dashboard").attr("data-filter",B);$(".q_dashboard_filter_button").removeClass("active");$(this).parents(".q_dashboard_filter_button").addClass("active");i.change_dashboard_filter_option(B)})};i.bulk_update=function(j){for(var k=0;k<j.length;k++){i.refresh_option_display(j[k],j[k]["status"])}};i.check_and_remove_from_suggestions=function(u){var k=u.unique_id;var n;if(!i.on_dashboard_page()){n="#suggested_items_in_q .q_item a[data-id="+k+"]";var q=$(n).parents(".q_item");$(q).html("").addClass("loading changing");var s=i.global_suggested_items;var l=s.length;var m=[];for(var p=0;p<l;p++){var j=s[p][2];var o={source:BLOOMBERG.global_var.Q_LINK_SOURCE,type:"Story",id:j};var t=($("#suggested_items_in_q .q_item a[data-id="+j+"]").size()>0);if(BLOOMBERG.queue.get_item_status(o)==d.NOT_IN_Q&&!t){m=s[p];i.global_suggested_items.splice(p,1);break}}var r="";if(m.length>0){r='<a class="q q_headline" href="'+m[1]+'" data-id="'+m[2]+'" data-type="Story">'+m[0]+'</a><a href="javascript:;" class="q_style_button from_suggested add_to_q"  title="Add to queue"></a><div style="clear:both"></div>';$(q).html(r).removeClass("loading")}else{$(q).remove();if($("#suggested_items_in_q .q_item").size()<1){$("#suggested_items_in_q").hide()}}}else{n="#q_suggestion_rows .suggested_q_item[data-id="+k+"]";$(n).remove();if($("#q_suggestion_rows .suggested_q_item").size()<4){$("#q_suggestion_panel_scroll_buttons").hide();$("#q_suggestion_rows_abs_container").css("top","0")}}};i.global_suggested_items=[];i.render_suggestion_panel=function(r){var u=function(j){var l=[];var z;for(var y=0;y<j.length;y++){z=j[y][2];var x={source:BLOOMBERG.global_var.Q_LINK_SOURCE,type:"Story",id:z};if(BLOOMBERG.queue.get_item_status(x)==d.NOT_IN_Q){l.push(j[y])}}BLOOMBERG.q_ui.global_suggested_items=l;return l};var m=function(y){var z,x,B;for(var A=0;A<2;A++){z=y[A][0];x=y[A][1];B=y[A][2];var j="#suggested_items_in_q .q_item:eq("+A+")";$(j).html('<a class="q q_headline" href="'+x+'" data-id="'+B+'" data-type="Story">'+z+'</a><a href="javascript:;" class="q_style_button from_suggested add_to_q" title="Add to queue"></a><div style="clear:both"></div>').removeClass("loading")}i.view_suggestions()};var q=function(G){var D,y,j;var A="";var z="";var x="";var C=4;var E=($("#q_suggested_items_panel").size()>0)?G.length:1;for(var B=0;B<E;B++){var F=(B==(E-1))?"last":"";D=G[B][0];y=G[B][1];j=G[B][2];w+=61;z+='<div class="suggested_q_item '+F+'" data-id="'+j+'"><a href="javascript:;" class="q_style_button from_suggested add_to_q"  title="Add to queue"></a><a href="'+y+'" class="suggested_q_thumbnail"></a><a href="'+y+'" class="q suggested_q_headline" data-id="'+j+'" data-type="Story">'+D+'</a><div class="suggested_q_clear"></div></div>'}if(E>4){x+='<div id="q_suggestion_panel_scroll_buttons"><a href="javascript:;" id="q_panel_scroll_up" class="up">Up</a><a href="javascript:;" id="q_panel_scroll_down" class="down">Down</a></div>';w=243}A+='<div id="q_suggestion_panel"><div id="q_suggestion_panel_header"><div id="q_suggestion_panel_header_text">Suggested for your queue</div></div><div id="q_suggestion_rows" style="height: '+w+'px;"><div id="q_suggestion_rows_abs_container">'+z+"</div></div></div>";$("#q_suggested_items_panel").html(A+x);$("#q_suggestion_panel_scroll_buttons a").click(function(M){M.preventDefault();if($(this).hasClass("inactive")){}else{$(this).siblings().removeClass("inactive");var Q=$(".suggested_q_item:first").outerHeight();var I=parseInt(Q);var N=4;var L=($(".suggested_q_item").size()*I)-(I*N);var K="+="+Q;var O=$("#q_suggestion_rows_abs_container").position();var J=$("#q_suggestion_rows_abs_container").queue("fx");var l=$("#q_suggestion_rows_abs_container").children(".suggested_q_item").clone();if(J.length==0){if($(this).hasClass("down")){K="-="+Q;$(".suggested_q_item.last").removeClass("last");O=$("#q_suggestion_rows_abs_container").position();R=Math.abs(O.top);if(R>=L){$("#q_suggestion_rows_abs_container").append(l);$("#q_suggestion_rows_abs_container").animate({top:K},"fast")}else{$("#q_suggestion_rows_abs_container").animate({top:K},"fast")}}if($(this).hasClass("up")){K="+="+Q;O=$("#q_suggestion_rows_abs_container").position();var R=Math.abs(O.top);if(R<=0){var P=$(".suggested_q_item:last").removeClass("last").clone();var H=R-Q+"px";$("#q_suggestion_rows_abs_container").css("top",H);$("#q_suggestion_rows_abs_container").prepend(P);$("#q_suggestion_rows_abs_container").animate({top:K},"fast",function(){$(".suggested_q_item:last").remove()})}else{$("#q_suggestion_rows_abs_container").animate({top:K},"fast")}}}}})};var s,n,t,p;var w=0;var k=BLOOMBERG.b_persist.get("viewed_suggestions");if(!k){k=""}var v=k.split(",");if(r.status==500){$("#suggested_items_in_q").remove();return false}t=r.QuintRec.StoryV;var o=u(t);if($("#q_dashboard").size()<=0){m(o)}else{q(o)}};i.track_click=function(l,k){var j=$(window).width();var q=$(window).height();var m=$(window).scrollTop();var r=k.offset();var n=l.pageY;var o=l.pageX;var p=new global_tracking(n,o,j,q,m,r);return p};i.track_position=function(m){var j=$(window).width();var l=$(window).height();var k=$(window).scrollTop();var n=m.offset();var o=new global_tracking("","",j,l,k,n);return o};i.render_heat_map=function(){$(".q_tracking_marker").remove();for(var k=0;k<global_tracking_array.length;k++){var j=$(window).width();var m=(global_tracking_array[k].ww-j)/2;var l=global_tracking_array[k].obj_offset.left-m;$("body").append('<div class="q_tracking_marker" style="left:'+l+"px; top:"+global_tracking_array[k].obj_offset.top+'px"></div>')}};i.trigger_read=function(){var j=i.story_page_selector+" a.q:first";if($(i.video_page_selector).size()>0){j=i.video_page_selector+" a.q:first"}var k=$(j).attr("data-type");var n=$(j).attr("data-id");var m=BLOOMBERG.global_var.Q_LINK_SOURCE;var l={source:m,type:k,id:n};BLOOMBERG.queue.read_item(m,k,n)};i.view_suggestions=function(){var j=BLOOMBERG.b_persist.get("viewed_suggestions");if(!j){j=""}$("#suggested_items_in_q a.q").each(function(){j+=","+$(this).attr("data-id")});BLOOMBERG.b_persist.set("viewed_suggestions",j)}})();var global_tracking_array=[];var global_tracking=function(d,f,c,a,b,e){this.my=d;this.mx=f;this.ww=c;this.wh=a;this.st=b;this.obj_offset=e};function hide_empty_mini_q_item(){$("#items_in_q .q_item").each(function(){if($.trim($(this).text())==""||$(this).hasClass("empty_q")){$(this).hide();$(this).siblings(".q_item").addClass("not_last")}})};